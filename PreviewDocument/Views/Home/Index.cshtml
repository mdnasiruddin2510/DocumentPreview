@{
    ViewData["Title"] = "Home Page";
}

<div class="text-center">
    <h1 class="display-4">Document Viewer</h1>
    </br>
    @*<form action="@Url.Action("ViewDocument")" method="post">
        <label>Select File To View</label>
        <input type="file" name="fileToView" />
        <input type="submit" class="btn btn-primary" value="Render"/>
    </form>*@
    <input type="file" id="files" name="fileToView" />
    <input type="button" id="btnPreview" class="btn btn-primary" value="Preview" onclick="PreviewWordDoc()" />
    <div id="word-container" class=""></div>
</div>
<script type="text/javascript" src="https://unpkg.com/jszip/dist/jszip.min.js"></script>
<script src="~/js/docx-preview.js"></script>
<script type="text/javascript">
    function PreviewWordDoc() {
        //Read the Word Document data from the File Upload.
        var doc = document.getElementById("files").files[0];

        //If Document not NULL, render it.
        if (doc != null) {
            //Set the Document options.
            var docxOptions = Object.assign(docx.defaultOptions, {
                useMathMLPolyfill: true
            });
            //Reference the Container DIV.
            var container = document.querySelector("#word-container");

            //Render the Word Document.
            docx.renderAsync(doc, container, null, docxOptions);
        }
    }
</script>